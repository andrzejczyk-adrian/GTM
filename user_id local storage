// pobiera email z automatycznego tagu User data - auto

<script>
  (function() {
    // Pobierz wartość zmiennej GTM, która jest obiektem
    var userData = {{User data - auto}};
    
    // Wyciągnij tylko adres e-mail
    var email = userData.email;

    // Funkcja do ustawienia wartości w localStorage
    function setLocalStorage(name, value) {
      if (value) {
        localStorage.setItem(name, value);
      }
    }

    // Funkcja do czyszczenia wartości z localStorage
    function clearLocalStorage(name) {
      localStorage.removeItem(name);
    }

    // Funkcja do ustawienia ciasteczka
    function setCookie(name, value, days) {
      var expires = "";
      if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        expires = "; expires=" + date.toUTCString();
      }
      document.cookie = name + "=" + (value || "") + expires + "; path=/";
    }

    // Sprawdź, czy email nie jest pusty
    if (email && email.trim() !== "") {
      // Wyczyszczenie istniejącego emaila z localStorage
      clearLocalStorage("userID");

      // Zapisz nowy email w localStorage
      setLocalStorage("userID", email);

      // Ustaw ciasteczko userID na 300 dni
      setCookie("userID", email, 300);
    }
  })();
</script>
